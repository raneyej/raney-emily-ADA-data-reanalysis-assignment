---
title: "raney-emily-ADA-data-reanalysis-assignment"
author: "Emily Raney"
date: "4/14/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
**Introduction**

Adult Neandertal skeletons are marked by a high frequency of traumatic lesions. These hominins exhibit a clear injury pattern, with a concentration of lesions around the head and neck, and relatively few lesions in the pelvic girdle and lower limb. Despite the consistency of this pattern in the Neandertal fossil record, its cause is not clear. This study by Berger and Trinkaus attempts to answer two questions about Neandertal inuries: 

1. Is the injury pattern of Neandertals different than the injury pattern of extant humans? 

2. Does behavior account for Neandertal injury distribution? 

One possible explanation is that Neandertals were engaging in close-range hunting of large prey (i.e., ungulates and horses), which led to the characteristic clustering of injuries around the head and neck. To test this hypothesis, their injury patterns were compared with those of a *Homo sapiens* population that engages in a similar activity pattern- North American rodeo performers. 

**Data**

The data set consists of counts of traumatic lesions found in both Neandertal and *H. sapiens* samples. It is important to note here that for this analysis, *N* is the number of lesions found in the population. The *H. sapiens* samples consist of three archaeological samples, three clinical samples, and one highly specialized athletic sample. The archaeological samples include: a sample from an Indigenous population from the Carlston Annis site in Kentucky (Bt-5; 223 lesions); a sample from an Indigenous population from the Libben site in Ohio (Libben; 94 lesions); and a sample from a number of cemeteries near the Nile Valley in southern Egypt (Nubia; 160 lesions). The clinical samples include lesions formally diagnosed and described in a medical setting. They include: a sample of fractures treated at London Hospital in 1907 (London; 1,730 lesions); a sample of fractures treated at the Hudson Hospital in New York City in the late 19th century (New York; 11,959 lesions); and a sample of fractures documented for the purposes of the NM Workers Compensation Administration from 1992-1993 (New Mexico; 792 lesions). The athletic sample consists of injuries reported by North American Rodeo performers (Rodeo; 181 lesions). 


The Neandertal sample consists of 17 individuals from western Europe and southwest Asia with a total of 27 traumatic lesions (Neandertal total). There are three additional subsets within this sample. Four of the Neandertal lesions are not directly associated with a specific fracture; rather, they are the result of post-traumatic degenerative joint disease (DJD). The *Neandertals w/o DJD* sample includes only the lesions associated with fractures (23 lesions). Additionally, the individual Shanidar I has 6 lesions; this accounts for 22% of the total lesions found in Neandertals. In case Shanidar I is an outlier, the sample *Neandertals w/o Shanidar I* excludes him from the total count (21 lesions). Finally, the sample *Neandertals w/o Shanidar I & DJD* consists of 18 lesions. 


**Analysis**

The original analysis does not consist of much descriptive statistical analysis beyond converting injury counts to percentages. Those are replicated in Table 2. 


Chi-square and *P* values were computed between each *H. sapiens* sample and the four different Neandertal samples; in this analysis, the *H. sapiens* samples act as the expected value, and the Neandertal samples act as the observed values. Additionally, the chi-square values are standardized to assess which anatomical areas of injury among the Neandertals differ most significantly from *H. sapiens*. 

**Data and Summary Statistics**
```{r}
library(tidyverse)
library(curl)
library(readr)
f <- "https://raw.githubusercontent.com/raneyej/raney-emily-ADA-data-reanalysis-assignment/main/Neandertal%20Trauma%20Data.csv"
trauma <- read.csv(f, header = TRUE, sep = ",")
head(trauma)
library(knitr)
kable(trauma, caption = "Table 1: Traumatic Lesion Counts") #This creates a table of the raw lesion counts for each sample
g <- "https://raw.githubusercontent.com/raneyej/raney-emily-ADA-data-reanalysis-assignment/main/Trauma%20Percentages.csv"
trauma_pct <- read.csv(g, header = TRUE, sep = ",")
head(trauma_pct)
kable(trauma_pct, caption = "Table 2: Traumatic Lesion Percentages") #This creates a table of the percentage of lesions by anatomical region
```
```{r, echo=FALSE, out.width="50%", fig.cap="Table 2 from Berger and Trinkaus."}
knitr::include_graphics("C:/Users/Emily/Pictures/img/table_two.png")
#This is the table from Berger and Trinkaus for comparison. The resolution is really low because it's a screenshot. They included the raw counts and each corresponding percentage in the same cell. I separated them out into two tables because I think it's better for visualization. 
```
```{r}
h <- "https://raw.githubusercontent.com/raneyej/raney-emily-ADA-data-reanalysis-assignment/main/Trauma%20Proportions.csv"
trauma_prop <- read.csv(h, header = TRUE, sep = ",")
Head.Neck_mean <- mean(trauma_prop$Head.Neck)
Head.Neck_sd <- sd(trauma_prop$Head.Neck)
Trunk_mean <- mean(trauma_prop$Trunk)
Trunk_sd <- sd(trauma_prop$Trunk)
Shoulder.Arm_mean <- mean(trauma_prop$Shoulder.Arm)
Shoulder.Arm_sd <- sd(trauma_prop$Shoulder.Arm)
Hand_mean <- mean(trauma_prop$Hand)
Hand_sd <- sd(trauma_prop$Hand)
Pelvis_mean <- mean(trauma_prop$Pelvis)
Pelvis_sd <- sd(trauma_prop$Pelvis)
Leg_mean <- mean(trauma_prop$Leg)
Leg_sd <- sd(trauma_prop$Leg)
Foot_mean <- mean(trauma_prop$Foot)
Foot_sd <- sd(trauma_prop$Foot)
Head.Neck_sum <- c(Head.Neck_mean, Head.Neck_sd)
Trunk_sum <- c(Trunk_mean, Trunk_sd)
Shoulder.Arm_sum <- c(Shoulder.Arm_mean, Shoulder.Arm_sd)
Hand_sum <- c(Hand_mean, Hand_sd)
Pelvis_sum <- c(Pelvis_mean, Pelvis_sd)
Leg_sum <- c(Leg_mean, Leg_sd)
Foot_sum <- c(Foot_mean, Foot_sd)
Trauma_Summary <- data.frame(Head.Neck_sum, Trunk_sum, Shoulder.Arm_sum, Hand_sum, Pelvis_sum, Leg_sum, Foot_sum)
Trauma_Summary
row.names(Trauma_Summary) <- c("Mean", "Standard Deviation")
Trauma_Summary
kable(Trauma_Summary, caption = "Table 3: Traumatic Lesion Distribution Summary")
```

These summary statistics aren't included in the original analysis; I imagine it's because it's such a small data set that you can get a pretty good idea of the distribution of injuries just by looking at the tables. I included them just for the sake of getting some practice with generating summary statistics. Interestingly, head/neck injuries and trunk injuries have similar standard deviations. Perhaps there is something unusual about the pattern of trunk injuries among Neandertals and *H. sapiens*.


**Visualization**
```{r}
Trauma_comp <- data.frame(Region = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"),
                          Neandertal_value = c(0.296,	0.148,	0.259,	0.037,	0.037,	0.111,	0.111),
                          Bt_5_value = c(0.018,	0.511,	0.224,	0.063,	0.031,	0.09,	0.063), 
                          Libben_value = c(0.064,	0.213,	0.297,	0,	0,	0.394,	0.032),
                          Nubia_value = c(0.106,	0.069,	0.531,	0.019,	0.038,	0.226,	0.013), 
                          London_value = c(0.062,	0.07,	0.316,	0.244,	0.002,	0.236,	0.07),
                          New_York_value = c(0.137,	0.123,	0.253,	0.219,	0.005,	0.206,	0.056), 
                          New_Mexico_value = c(0.016,	0.125,	0.231,	0.236,	0.021,	0.111,	0.259), 
                          Rodeo_value = c(0.392,	0.099,	0.259,	0.061,	0.033,	0.061,	0.094))
Trauma_comp
#I restructured my data frame in order to graph it.
level_region <- factor(Trauma_comp$Region, level = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot")) #When the x variables are categorical, ggplot automatically orders them alphabetically. I had to manually change the order of the variables so they matched the order in the graph from Berger and Trinkaus.
colors <- c("Neandertals" = "hotpink", "Bt_5" = "springgreen2", "Libben" = "royalblue1", "Nubia" = "magenta3") #I set my own color scheme.
Trauma_plot <- ggplot(Trauma_comp, aes(x=level_region, group=1)) +
  geom_line(aes(y=Neandertal_value, color = "Neandertals")) +
  geom_line(aes(y=Bt_5_value, color = "Bt_5")) +
  geom_line(aes(y=Libben_value, color = "Libben")) +
  geom_line(aes(y=Nubia_value, color = "Nubia")) +
  ylim(0.0, 0.6)
Trauma_plot + labs(title = "Traumatic Injury Distribution", 
                   x = "Anatomical Region", y = "Proportion", color = "Legend",
                   caption = "Figure 1: Traumatic injury distribution comparison between Neandertals and three extant human populations") +
  scale_color_manual(values = colors)
```

```{r, echo=FALSE, out.width="50%", fig.cap="Figure 1 from Berger and Trinkaus."}
knitr::include_graphics("C:/Users/Emily/Pictures/img/figure_one.png")
#This is Figure 1 from Trinkaus and Berger. 
```

```{r}
No_DJD <- data.frame(Region = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"),
                          Neandertal_noDJD_value = c(0.304,	0.174,	0.304,	0.043,	0,	0.13,	0.043),
                          London_value = c(0.062,	0.07,	0.316,	0.244,	0.002,	0.236,	0.07),
                          New_York_value = c(0.137,	0.123,	0.253,	0.219,	0.005,	0.206,	0.056), 
                          New_Mexico_value = c(0.016,	0.125,	0.231,	0.236,	0.021,	0.111,	0.259))

level_region <- factor(Trauma_comp$Region, level = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot")) 
colors_4 <- c("Neandertals w/o DJD" = "turquoise3", "London" = "mediumblue", "New York" = "darkorange", "New Mexico" = "purple1")
No_DJD_plot <- ggplot(No_DJD, aes(x=level_region, group=1)) +
  geom_line(aes(y=Neandertal_noDJD_value, color = "Neandertals w/o DJD")) +
  geom_line(aes(y=London_value, color = "London")) +
  geom_line(aes(y=New_York_value, color = "New York")) +
  geom_line(aes(y=New_Mexico_value, color = "New Mexico")) +
  ylim(0.0, 0.6)
No_DJD_plot + labs(title = "Traumatic Injury Distribution", 
                   x = "Anatomical Region", y = "Proportion", color = "Legend",
                   caption = "Figure 2: Traumatic injury distribution comparisons between Neandertals without DJD and clinical extant human samples") +
  scale_color_manual(values = colors_4)
```

```{r, echo=FALSE, out.width="50%", fig.cap="Figure 2 from Berger and Trinkaus."}
knitr::include_graphics("C:/Users/Emily/Pictures/img/figure_two.png")
#This is Figure 2 from Trinkaus and Berger. 
```

Just for fun, here are some extra visualizations. 

Comparison of Neandertals and all seven extant human samples: 

```{r}
level_region <- factor(Trauma_comp$Region, level = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot")) 
colors_2 <- c("Neandertals" = "hotpink", "Bt_5" = "springgreen2", "Libben" = "royalblue1", "Nubia" = "magenta3", "London" = "mediumblue", "New York" = "darkorange", "New Mexico" = "purple1",  "Rodeo" = "red2")
Trauma_plot_2 <- ggplot(Trauma_comp, aes(x=level_region, group=1)) +
  geom_line(aes(y=Neandertal_value, color = "Neandertals")) +
  geom_line(aes(y=Bt_5_value, color = "Bt_5")) +
  geom_line(aes(y=Libben_value, color = "Libben")) +
  geom_line(aes(y=Nubia_value, color = "Nubia")) +
  geom_line(aes(y=London_value, color = "London")) +
  geom_line(aes(y=New_York_value, color = "New York")) +
  geom_line(aes(y=New_Mexico_value, color = "New Mexico")) +
  geom_line(aes(y=Rodeo_value, color = "Rodeo")) +
  ylim(0.0, 0.6)
Trauma_plot_2 + labs(title = "Traumatic Injury Distribution (All Samples)", 
                   x = "Anatomical Region", y = "Proportion", color = "Legend",
                   caption = "Figure 3: Traumatic injury distribution comparison between Neandertals and all extant human samples") +
  scale_color_manual(values = colors_2)
```

Comparison of Neandertals and rodeo performers: 

```{r}
level_region <- factor(Trauma_comp$Region, level = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot")) 
colors_3 <- c("Neandertals" = "hotpink", "Rodeo" = "purple2")
Trauma_plot_3 <- ggplot(Trauma_comp, aes(x=level_region, group=1)) +
  geom_line(aes(y=Neandertal_value, color = "Neandertals")) +
  geom_line(aes(y=Rodeo_value, color = "Rodeo")) + 
  ylim(0.0, 0.6)
Trauma_plot_3 + labs(title = "Traumatic Injury Distribution of Neandertals and Rodeo Performers", x = "Anatomical Region", y = "Proportion", color = "Legend", caption = "Figure 4: Traumatic injury distribution comparison between Neandertals and rodeo performers") +
  scale_color_manual(values = colors_3)
```

Here is the same set of plots but in bar graph form. I think bar graphs are a better choice to visualize this data set. 

Neandertals and three extant human samples compared: 
```{r}
Trauma_comp_2 <- data.frame(Region = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"),
                            Neandertal_value = c(0.296,	0.148,	0.259,	0.037,	0.037,	0.111,	0.111),
                            Bt_5_value = c(0.018,	0.511,	0.224,	0.063,	0.031,	0.09,	0.063), 
                            Libben_value = c(0.064,	0.213,	0.297,	0,	0,	0.394,	0.032),
                            Nubia_value = c(0.106,	0.069,	0.531,	0.019,	0.038,	0.226,	0.013)) 
Trauma_comp_2_long <- gather(Trauma_comp_2, Sample, Proportion, -Region)
Trauma_comp_2_long #I put the data in long form to make a bar graph. 
Trauma_comp_2_long$Region <- factor(Trauma_comp_2_long$Region, levels = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot")) #I manually reset the order of the variables again. 
Trauma_bar_2 <- ggplot(data = Trauma_comp_2_long, aes(x = Region, y = Proportion, fill = Sample)) +
  geom_col(position = position_dodge())
Trauma_bar_2+scale_fill_manual(values = c("hotpink", "springgreen2", "royalblue1", "magenta3"))+labs(caption = "Figure 5: Traumatic injury distribution comparison between Neandertals and three extant human populations")
```

Neandertals and all extant human samples compared (this graph is pure chaos, but still kind of fun to look at):

```{r}
Trauma_comp_3 <- data.frame(Region = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"),
                            Neandertal_value = c(0.296,	0.148,	0.259,	0.037,	0.037,	0.111,	0.111),
                            Bt_5_value = c(0.018,	0.511,	0.224,	0.063,	0.031,	0.09,	0.063), 
                            Libben_value = c(0.064,	0.213,	0.297,	0,	0,	0.394,	0.032),
                            Nubia_value = c(0.106,	0.069,	0.531,	0.019,	0.038,	0.226,	0.013), 
                            London_value = c(0.062,	0.07,	0.316,	0.244,	0.002,	0.236,	0.07),
                            New_York_value = c(0.137,	0.123,	0.253,	0.219,	0.005,	0.206,	0.056), 
                            New_Mexico_value = c(0.016,	0.125,	0.231,	0.236,	0.021,	0.111,	0.259), 
                            Rodeo_value = c(0.392,	0.099,	0.259,	0.061,	0.033,	0.061,	0.094))
Trauma_comp_3_long <- gather(Trauma_comp_3, Sample, Proportion, -Region)
Trauma_comp_3_long
Trauma_comp_3_long$Region <- factor(Trauma_comp_3_long$Region, levels = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"))
Trauma_bar_3 <- ggplot(data = Trauma_comp_3_long, aes(x = Region, y = Proportion, fill = Sample)) +
  geom_col(position = position_dodge()) 
Trauma_bar_3+scale_fill_manual(values = c("hotpink", "springgreen2", "royalblue1", "magenta3", "mediumblue", "darkorange", "purple1",  "red2"))+labs(caption = "Figure 6: Comparison of Neandertal and all extant human samples")
```

Neandertals and rodeo performers compared: 

```{r}
Trauma_comp_4 <- data.frame(Region = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"),
                            Neandertal_value = c(0.296,	0.148,	0.259,	0.037,	0.037,	0.111,	0.111),
                            Rodeo_value = c(0.392,	0.099,	0.259,	0.061,	0.033,	0.061,	0.094))
Trauma_comp_4_long <- gather(Trauma_comp_4, Sample, Proportion, -Region)
Trauma_comp_4_long
Trauma_comp_4_long$Region <- factor(Trauma_comp_4_long$Region, levels = c("Head.Neck", "Trunk", "Shoulder.Arm", "Hand", "Pelvis", "Leg", "Foot"))
Trauma_bar_4 <- ggplot(data = Trauma_comp_4_long, aes(x = Region, y = Proportion, fill = Sample)) +
  geom_col(position = position_dodge()) 
Trauma_bar_4+scale_fill_manual(values = c("hotpink", "purple2"))+labs(caption = "Figure 7: Comparison of Neandertals and rodeo performers")
```

These extra graphs weren't totally necessary, but I'm trying to get more practice using ggplot! 
